# 作品選択モード（BookSelectMode）デザイン仕様書

> **Task ID**: P1-DE-001
> **Designer**: 玉田（第1中隊デザイン担当）
> **対象**: アリサ（FE実装担当）
> **作成日**: 2026-01-30

---

## 1. 概要

- **用途**: ユーザーが読みたい作品を直感的に探索・選択するための画面
- **コンセプト**: TikTok/Tinder風のカードスワイプUI + 和紙テクスチャの温かみ
- **対象画面**: `/discover` ルート（メイン導線）

---

## 2. 画面レイアウト（モバイル基準: 390 x 844px）

```
┌─────────────────────────────────┐
│  ステータスバー                    │ ← OS領域
├─────────────────────────────────┤
│  ヘッダー (56px)                  │
│  [≡]   幽玄書庫   [🔍] [👤]     │
├─────────────────────────────────┤
│                                  │
│  ┌─────────────────────────┐    │
│  │                          │    │
│  │     カバー画像            │    │
│  │     (アスペクト比 3:4)    │    │
│  │                          │    │
│  │                          │    │
│  │                          │    │
│  │  ┌───────────────────┐  │    │
│  │  │  和紙テクスチャ      │  │    │
│  │  │  グラデーション       │  │    │
│  │  │  オーバーレイ        │  │    │
│  │  │                    │  │    │
│  │  │  ジャンルタグ        │  │    │
│  │  │  [ミステリー] [短編]  │  │    │
│  │  │                    │  │    │
│  │  │  タイトル（H2）      │  │    │
│  │  │  著者名             │  │    │
│  │  │                    │  │    │
│  │  │  あらすじ（3行）     │  │    │
│  │  │  続きを読む ▸        │  │    │
│  │  └───────────────────┘  │    │
│  └─────────────────────────┘    │
│                                  │
│  ← ✕     ● ● ○ ○ ○     ♡ →    │ ← アクションヒント
│                                  │
├─────────────────────────────────┤
│  ボトムナビ (64px)               │
│  [探す] [本棚] [しおり] [設定]    │
└─────────────────────────────────┘
```

---

## 3. カードコンポーネント仕様

### 3.1 BookCard

| プロパティ | 値 | 備考 |
|-----------|-----|------|
| 幅 | `calc(100vw - 32px)` | 左右マージン16px |
| 高さ | `calc(100vh - 184px)` | ヘッダー56px + ボトムナビ64px + アクションヒント40px + マージン24px |
| 角丸 | `16px` | |
| シャドウ | `0 8px 32px rgba(0,0,0,0.12)` | |
| border | なし | |
| overflow | `hidden` | |
| background | `#FFFFFF` (light) / `#252525` (dark) | |

### 3.2 カバー画像エリア

| プロパティ | 値 |
|-----------|-----|
| 高さ | カード高さの **60%** |
| object-fit | `cover` |
| フォールバック | 和紙テクスチャ + タイトル文字（画像なし時） |

### 3.3 和紙グラデーションオーバーレイ

```css
/* ライトモード */
background: linear-gradient(
  to bottom,
  transparent 0%,
  rgba(249, 248, 246, 0.3) 40%,
  rgba(249, 248, 246, 0.85) 70%,
  #F9F8F6 100%
);

/* ダークモード */
background: linear-gradient(
  to bottom,
  transparent 0%,
  rgba(26, 26, 26, 0.3) 40%,
  rgba(26, 26, 26, 0.85) 70%,
  #1A1A1A 100%
);
```

**和紙テクスチャ**: `mix-blend-mode: overlay`, `opacity: 0.08` で全体にうっすら重ねる。
CSS実装としては `background-image` に和紙パターンSVGを使用。

### 3.4 テキスト情報エリア

カード下部 40% に配置（オーバーレイ上に）。

| 要素 | フォント | サイズ | ウェイト | カラー (Light / Dark) |
|------|---------|--------|---------|----------------------|
| ジャンルタグ | Noto Sans JP | 12px | Medium (500) | `#9D8CA1` / `#C5A059` |
| タイトル | Noto Sans JP | 24px | Bold (700) | `#2D2D2D` / `#E8E6E3` |
| 著者名 | Noto Sans JP | 14px | Regular (400) | `#6B7280` / `#9CA3AF` |
| あらすじ | Noto Sans JP | 14px | Regular (400) | `#4B5563` / `#D1D5DB` |
| 続きを読む | Noto Sans JP | 13px | Medium (500) | `#9D8CA1` / `#C5A059` |

### 3.5 ジャンルタグ

| プロパティ | 値 |
|-----------|-----|
| padding | `4px 12px` |
| border-radius | `999px` (pill形状) |
| background (light) | `rgba(157, 140, 161, 0.12)` |
| background (dark) | `rgba(197, 160, 89, 0.15)` |
| border | `1px solid rgba(157, 140, 161, 0.2)` (light) |
| max表示数 | 3個（超過時は `+N` 表示） |
| gap | `8px` |

---

## 4. カードスタックの振る舞い

### 4.1 スタック表示

- 画面上に最大 **3枚** のカードをスタック表示
- 前面カード: `z-index: 3`, `scale(1)`, `opacity: 1`
- 2枚目: `z-index: 2`, `scale(0.95)`, `translateY(-8px)`, `opacity: 0.7`
- 3枚目: `z-index: 1`, `scale(0.90)`, `translateY(-16px)`, `opacity: 0.4`

### 4.2 スワイプアニメーション

| アクション | 方向 | 閾値 | アニメーション |
|-----------|------|------|--------------|
| お気に入り登録 | 右スワイプ | `> 100px` or `velocity > 0.5` | カードが右方向に飛び出し + 回転(15deg) + フェードアウト |
| 興味なし | 左スワイプ | `> 100px` or `velocity > 0.5` | カードが左方向に飛び出し + 回転(-15deg) + フェードアウト |
| キャンセル | 閾値未満 | `< 100px` | バネアニメーションで中央に戻る |

**スワイプ中のフィードバック:**
- 右方向ドラッグ → `♡` アイコンがフェードイン（カード右上）, カード枠がアクセントカラーに
- 左方向ドラッグ → `✕` アイコンがフェードイン（カード左上）, カード枠がグレーに
- opacity は移動距離に連動（`Math.min(distance / 100, 1)`）

### 4.3 ダブルタップ

- カードの任意の場所をダブルタップ → 即座に読書モードへ遷移
- タップ間隔: `300ms` 以内
- フィードバック: カード中央に「開く」の波紋エフェクト + ページめくりトランジション

### 4.4 トランジション

```
duration: 300ms (スワイプ完了)
duration: 200ms (スナップバック)
easing: cubic-bezier(0.25, 0.46, 0.45, 0.94)  // ease-out系
```

---

## 5. ヘッダー仕様

| 要素 | 位置 | サイズ | 動作 |
|------|------|--------|------|
| ハンバーガーメニュー | 左 | 24px icon | サイドドロワー開閉 |
| アプリ名「幽玄書庫」 | 中央 | 20px, Bold | 縦書きスタイルも検討可 |
| 検索アイコン | 右1 | 24px icon | 検索オーバーレイ展開 |
| プロフィール | 右2 | 24px icon | プロフィール画面遷移 |

**ヘッダースタイル:**
- `backdrop-filter: blur(12px)` で半透明すりガラス効果
- `background: rgba(249, 248, 246, 0.85)` (light)
- `background: rgba(26, 26, 26, 0.85)` (dark)
- `border-bottom: 1px solid rgba(0,0,0,0.06)`
- `position: sticky; top: 0`

---

## 6. ボトムナビゲーション

| タブ | アイコン | ラベル | ルート |
|------|---------|--------|--------|
| 探す | compass | 探す | `/discover` (このページ) |
| 本棚 | book-open | 本棚 | `/bookshelf` |
| しおり | bookmark | しおり | `/bookmarks` |
| 設定 | settings | 設定 | `/settings` |

**スタイル:**
- `height: 64px` (safe-area含む: `calc(64px + env(safe-area-inset-bottom))`)
- アクティブ: アクセントカラー (`#9D8CA1` / `#C5A059`)
- 非アクティブ: `#9CA3AF`
- `backdrop-filter: blur(12px)` 同様すりガラス

---

## 7. アクションヒントバー

カードとボトムナビの間に配置。

```
←  ✕        ● ● ○ ○ ○        ♡  →
スキップ    ページインジケータ    お気に入り
```

| 要素 | サイズ | カラー |
|------|--------|--------|
| ✕ ボタン | 40px circle | `#E5E7EB` bg, `#6B7280` icon |
| ♡ ボタン | 40px circle | `rgba(157,140,161,0.15)` bg, `#9D8CA1` icon |
| ドットインジケータ (active) | 8px | `#9D8CA1` / `#C5A059` |
| ドットインジケータ (inactive) | 6px | `#D1D5DB` / `#4B5563` |

---

## 8. 空状態・エッジケース

| ケース | 表示 |
|--------|------|
| 作品が尽きた | 和紙背景 + 「全ての作品を読みました」+ リフレッシュボタン |
| ネットワークエラー | 「接続を確認してください」+ リトライボタン |
| 読み込み中 | スケルトンカード（パルスアニメーション） |
| 画像読み込み失敗 | 和紙テクスチャ背景 + タイトル大きく中央配置 |

---

## 9. アクセシビリティ

| 項目 | 対応 |
|------|------|
| コントラスト比 | テキスト/背景で 4.5:1 以上 |
| スワイプ代替 | ✕/♡ ボタンでタップ操作可能 |
| スクリーンリーダー | `aria-label` で作品情報を読み上げ |
| モーション低減 | `prefers-reduced-motion` でアニメーション簡素化 |
| キーボード | 左右矢印キーでスキップ/お気に入り、Enterで読書開始 |

---

## 10. Tailwind CSS v4 実装メモ（アリサ向け）

### カラートークン定義（globals.css）

```css
@theme inline {
  /* 幽玄書庫カラーパレット */
  --color-yugen-bg: #F9F8F6;
  --color-yugen-text: #2D2D2D;
  --color-yugen-accent: #9D8CA1;
  --color-yugen-sub: #1B1F3B;

  --color-yugen-dark-bg: #1A1A1A;
  --color-yugen-dark-text: #E8E6E3;
  --color-yugen-dark-accent: #C5A059;
  --color-yugen-dark-sub: #D4C4A0;
}
```

### 推奨コンポーネント分割

```
src/features/discover/
├── atoms/
│   ├── GenreTag.tsx           # ジャンルタグpill
│   ├── ActionButton.tsx       # ✕/♡ 丸ボタン
│   └── DotIndicator.tsx       # ページドット
├── molecules/
│   ├── BookCardInfo.tsx        # タイトル+著者+あらすじ
│   └── ActionHintBar.tsx       # ✕ ドット ♡ バー
├── organisms/
│   ├── BookCard.tsx            # カード全体
│   └── BookCardStack.tsx       # カードスタック管理
├── hooks/
│   ├── useSwipeGesture.ts      # スワイプジェスチャー
│   └── useBookStack.ts         # カードスタックステート
└── pages.tsx                   # /discover ページ
```

### スワイプライブラリ推奨

- **framer-motion** の `useDragControls` + `useMotionValue`
- または **@use-gesture/react** + **react-spring**
- 軽量志向なら `@use-gesture/react` 単体 + CSS transitions
