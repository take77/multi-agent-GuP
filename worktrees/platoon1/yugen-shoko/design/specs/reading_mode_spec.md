# 読書モード（ReadingMode）デザイン仕様書

> **Task ID**: P1-DE-001
> **Designer**: 玉田（第1中隊デザイン担当）
> **対象**: アリサ（FE実装担当）
> **作成日**: 2026-01-30

---

## 1. 概要

- **用途**: 作品を没入感をもって読むための全画面読書画面
- **コンセプト**: 「和紙の温かみ・書店の静けさ」を体現する落ち着いた読書空間
- **対象画面**: `/read/[bookId]/[chapterId]` ルート

---

## 2. 画面レイアウト（モバイル基準: 390 x 844px）

### 2.1 通常状態（UI非表示 / 没入モード）

```
┌─────────────────────────────────┐
│                                  │
│                                  │
│      本文テキストエリア            │
│      （全画面表示）               │
│                                  │
│      「吾輩は猫である。           │
│        名前はまだ無い。           │
│                                  │
│        どこで生れたか             │
│        とんと見当がつかぬ。        │
│        何でも薄暗いじめじめ       │
│        した所でニャーニャー        │
│        泣いていた事だけは          │
│        記憶している。」            │
│                                  │
│                                  │
│  ─────────────────────── 32%    │ ← 進捗バー（常時薄く表示）
└─────────────────────────────────┘
```

### 2.2 UIオーバーレイ表示時（シングルタップで切替）

```
┌─────────────────────────────────┐
│  ヘッダー (56px)                 │
│  [←]  第一章「猫の始まり」  [⋮]  │
├─────────────────────────────────┤
│                                  │
│      本文テキストエリア            │
│      （UIオーバーレイ下に表示）     │
│                                  │
│                                  │
│                                  │
│                                  │
│                                  │
│                                  │
│                                  │
├─────────────────────────────────┤
│  フッターコントロール (120px)      │
│                                  │
│  文字サイズ  [A-] ───●─── [A+]   │
│  明るさ      [☀] ───●─── [☀]   │
│                                  │
│  [🌙夜] [📖縦書] [Aa書体] [⚙]   │
│                                  │
│  ◀ 前の話 │ 3/12話 │ 次の話 ▶    │
└─────────────────────────────────┘
```

---

## 3. テキスト表示仕様

### 3.1 横書きモード（デフォルト）

| プロパティ | 値 | 備考 |
|-----------|-----|------|
| font-family | `"Noto Serif JP", serif` | 読書専用セリフ体 |
| font-size (default) | `18px` | 調整範囲: 14px - 28px (7段階) |
| line-height | `1.9` | 読みやすさ最重視 |
| letter-spacing | `0.04em` | |
| color (light) | `#2D2D2D` | |
| color (dark) | `#E8E6E3` | |
| padding (mobile) | `24px 20px` | |
| padding (tablet) | `40px 60px` | |
| padding (desktop) | `40px auto`, `max-width: 720px` | |
| text-align | `justify` | 両端揃え |

### 3.2 縦書きモード

| プロパティ | 値 |
|-----------|-----|
| writing-mode | `vertical-rl` |
| text-orientation | `mixed` |
| overflow-x | `auto` (横スクロール) |
| overflow-y | `hidden` |
| padding | `20px 24px` |
| column-gap | なし（連続スクロール） |

**縦書き時の注意:**
- 英数字は `text-combine-upright: all` で2桁まで縦中横
- ルビ対応: `<ruby>` タグで振り仮名表示
- スクロール方向: 右→左（`direction: rtl` on scroll container）

### 3.3 フォントサイズ段階

| レベル | サイズ | ラベル |
|--------|--------|--------|
| 1 | 14px | 極小 |
| 2 | 15px | 小 |
| 3 | 16px | やや小 |
| 4 | 18px | **標準（デフォルト）** |
| 5 | 20px | やや大 |
| 6 | 24px | 大 |
| 7 | 28px | 極大 |

---

## 4. 背景・テーマ仕様

### 4.1 テーマバリエーション

| テーマ | 背景色 | テキスト色 | 用途 |
|--------|--------|-----------|------|
| 昼（デフォルト） | `#F9F8F6` | `#2D2D2D` | 通常読書 |
| セピア | `#F5F0E8` | `#3E3226` | 温かみのある読書 |
| 夜 | `#1A1A1A` | `#E8E6E3` | 暗所読書 |
| 墨 | `#0D0D0D` | `#B8B5B0` | 完全ダーク / OLED節電 |

### 4.2 和紙テクスチャ

- 全テーマ共通で和紙テクスチャを `opacity: 0.04` で背景に重ねる
- `background-image: url('/textures/washi.svg')`
- `background-repeat: repeat`
- `background-size: 300px 300px`
- セピアテーマでは `opacity: 0.06` に上げて温かみを強調

---

## 5. ジェスチャー操作仕様

### 5.1 タップゾーン

```
┌───────┬───────┬───────┐
│       │       │       │
│ 前ページ│  UI   │ 次ページ│
│ (左1/4)│ 表示  │(右1/4) │
│       │(中央) │       │
│       │       │       │
└───────┴───────┴───────┘
```

| ゾーン | タップ動作 | 範囲 |
|--------|-----------|------|
| 左 1/4 | 前のページ/セクションへスクロール | `0% - 25%` |
| 中央 1/2 | UIオーバーレイの表示/非表示切替 | `25% - 75%` |
| 右 1/4 | 次のページ/セクションへスクロール | `75% - 100%` |

### 5.2 スワイプ操作

| ジェスチャー | 動作 | 閾値 |
|-------------|------|------|
| 縦スワイプ（上下） | テキストスクロール | ネイティブスクロール |
| 横スワイプ（左→右） | 前の話へ移動 | `> 120px` + 確認ダイアログ |
| 横スワイプ（右→左） | 次の話へ移動 | `> 120px` + 確認ダイアログ |

**話移動時の確認:**
```
┌──────────────────────────┐
│                           │
│  次の話に進みますか？       │
│                           │
│  第二章「猫の冒険」         │
│                           │
│   [やめる]    [進む]       │
│                           │
└──────────────────────────┘
```

### 5.3 ダブルタップ（しおり）

- 任意の位置でダブルタップ → しおりを挿入
- タップ位置のパラグラフにしおりマーカーが表示される
- マーカー: 左端に縦線 `3px solid #9D8CA1` (light) / `#C5A059` (dark)
- フィードバック: 画面上部にトースト「しおりを挟みました」(1.5秒表示)

```
┌─────────────────────────────┐
│  📎 しおりを挟みました        │  ← トースト (1.5s)
└─────────────────────────────┘

│  ┃ どこで生れたかとんと見当    │  ← しおりマーカー
│  ┃ がつかぬ。何でも薄暗い     │
```

### 5.4 ピンチイン/アウト（文字サイズ変更）

| ジェスチャー | 動作 |
|-------------|------|
| ピンチアウト（広げる） | 文字サイズ1段階アップ |
| ピンチイン（縮める） | 文字サイズ1段階ダウン |

- アニメーション: `transition: font-size 150ms ease-out`
- 変更後のサイズを画面中央に一瞬表示: `18px → 20px` (1秒フェードアウト)
- ピンチ操作のデバウンス: 300ms

---

## 6. UIオーバーレイ詳細

### 6.1 ヘッダー（読書時）

| 要素 | 位置 | 動作 |
|------|------|------|
| 戻るボタン `←` | 左 | 作品選択画面 or 本棚に戻る |
| 章タイトル | 中央 | 現在の章名表示 |
| メニュー `⋮` | 右 | ドロップダウンメニュー |

**メニュー項目:**
- 目次を表示
- しおり一覧
- この作品の情報
- 表示設定
- 共有する

### 6.2 フッターコントロール

#### 文字サイズスライダー

```
  A-  ──────────●────────  A+
  14px                    28px
```
- Tailwind: `input[type="range"]` カスタムスタイル
- トラック色: `#E5E7EB` (light), `#374151` (dark)
- サム色: `#9D8CA1` (light), `#C5A059` (dark)

#### 明るさスライダー

```
  ☀  ──●────────────────  ☀
  0%                     100%
```
- CSS `filter: brightness()` で画面全体の明るさ調整

#### クイック設定ボタン

| ボタン | ラベル | 動作 |
|--------|--------|------|
| 🌙 | 夜 | ダークテーマに切替 |
| 📖 | 縦書 | 縦書き/横書き切替 |
| Aa | 書体 | フォント選択パネル展開 |
| ⚙ | 設定 | 詳細設定画面へ |

#### 話ナビゲーション

```
  ◀ 前の話  │  3 / 12話  │  次の話 ▶
```

### 6.3 オーバーレイアニメーション

- 表示: `opacity 0→1`, `translateY(±20px→0)`, `duration: 200ms`
- ヘッダー: 上からスライドイン
- フッター: 下からスライドイン
- 背景: 上下にグラデーションオーバーレイ（テキスト視認性確保）

---

## 7. 進捗バー

画面最下部に常時表示（UIオーバーレイの表示/非表示に関わらず）。

| プロパティ | 値 |
|-----------|-----|
| height | `2px` (通常) / `4px` (UI表示時) |
| background (track) | `transparent` (通常) / `rgba(0,0,0,0.1)` (UI表示時) |
| background (fill) | `#9D8CA1` (light) / `#C5A059` (dark) |
| opacity | `0.4` (通常) / `1.0` (UI表示時) |
| transition | `all 200ms ease` |
| position | `fixed; bottom: 0` |

進捗バー右端にパーセンテージ表示:
- `font-size: 10px`
- `opacity: 0.5` (通常) / `1.0` (UI表示時)

---

## 8. フォント選択パネル

`Aa` ボタンタップで展開するボトムシート。

```
┌─────────────────────────────────┐
│  ─── （ドラッグハンドル）          │
│                                  │
│  書体を選択                      │
│                                  │
│  ┌─────────────────────────┐    │
│  │ ✓  Noto Serif JP        │    │ ← 選択中
│  │    明朝体・読書向き        │    │
│  └─────────────────────────┘    │
│  ┌─────────────────────────┐    │
│  │    Noto Sans JP          │    │
│  │    ゴシック体・シンプル     │    │
│  └─────────────────────────┘    │
│  ┌─────────────────────────┐    │
│  │    Zen Antique           │    │
│  │    アンティーク・和風      │    │
│  └─────────────────────────┘    │
│  ┌─────────────────────────┐    │
│  │    Shippori Mincho       │    │
│  │    しっぽり明朝・文学的    │    │
│  └─────────────────────────┘    │
│                                  │
│  プレビュー:                     │
│  「吾輩は猫である。名前はまだ無い。」│
│                                  │
└─────────────────────────────────┘
```

---

## 9. 空状態・エッジケース

| ケース | 表示 |
|--------|------|
| テキスト読み込み中 | スケルトンテキスト（行のパルスアニメーション） |
| 最終話到達 | 「最後まで読みました」+ 評価カード + 次の作品レコメンド |
| 第1話冒頭で左スワイプ | 「最初の話です」トースト |
| ネットワークエラー | キャッシュ済みテキスト表示 or リトライUI |
| しおり上限 | 1作品最大20個。超過時は古いものの削除確認 |

---

## 10. アクセシビリティ

| 項目 | 対応 |
|------|------|
| コントラスト比 | 全テーマで本文 7:1 以上（AAA準拠） |
| フォントサイズ | 最大28pxまで拡大可能 |
| モーション低減 | `prefers-reduced-motion` でトランジション無効化 |
| スクリーンリーダー | 章構造を `<article>`, `<section>`, `<h2>` でマークアップ |
| キーボード | 左右矢印で話移動、Space/PgDnでスクロール、Bでしおり |
| ハイコントラスト | 「墨」テーマで対応 |

---

## 11. Tailwind CSS v4 実装メモ（アリサ向け）

### 推奨コンポーネント分割

```
src/features/reader/
├── atoms/
│   ├── ProgressBar.tsx          # 進捗バー
│   ├── BookmarkMarker.tsx       # しおりマーカー
│   ├── FontSizeIndicator.tsx    # サイズ変更表示
│   └── ThemeButton.tsx          # テーマ切替ボタン
├── molecules/
│   ├── ReadingHeader.tsx         # 読書ヘッダー
│   ├── ReadingFooter.tsx         # フッターコントロール
│   ├── FontSelector.tsx          # フォント選択ボトムシート
│   ├── ChapterNavDialog.tsx      # 話移動確認ダイアログ
│   └── ReadingToast.tsx          # トースト通知
├── organisms/
│   ├── TextRenderer.tsx          # テキスト本文描画
│   ├── ReadingOverlay.tsx        # UIオーバーレイ全体
│   └── ReadingView.tsx           # 読書画面全体
├── hooks/
│   ├── useReadingGestures.ts     # タップ/スワイプ/ピンチ制御
│   ├── useReadingSettings.ts     # フォント/テーマ/サイズ設定
│   ├── useBookmarks.ts           # しおり管理
│   ├── useReadingProgress.ts     # 進捗追跡
│   └── useChapterNavigation.ts   # 話ナビゲーション
├── constants/
│   ├── themes.ts                 # テーマ定義
│   └── fonts.ts                  # フォント設定
├── store.ts                      # 読書設定ストア (localStorage永続化)
└── pages.tsx                     # /read/[bookId]/[chapterId]
```

### localStorage 永続化キー

| キー | 値 | デフォルト |
|------|-----|----------|
| `yugen-font-size` | `1-7` | `4` |
| `yugen-font-family` | string | `"Noto Serif JP"` |
| `yugen-theme` | `light\|sepia\|dark\|ink` | `light` |
| `yugen-writing-mode` | `horizontal\|vertical` | `horizontal` |
| `yugen-brightness` | `0-100` | `100` |
| `yugen-bookmarks-{bookId}` | JSON array | `[]` |
| `yugen-progress-{bookId}` | JSON object | `{}` |

### ページ遷移アニメーション

作品選択 → 読書モードのトランジション:
```
/* ページめくり風トランジション */
@keyframes page-turn-enter {
  from {
    transform: perspective(1200px) rotateY(-90deg);
    transform-origin: left center;
    opacity: 0;
  }
  to {
    transform: perspective(1200px) rotateY(0deg);
    transform-origin: left center;
    opacity: 1;
  }
}
/* duration: 500ms, easing: cubic-bezier(0.4, 0, 0.2, 1) */
```
